First activate virtual env:

source .venv/bin/activate
cd infrared
source etc/bash_completion.d/infrared

Copy topologies to Infrared:

cp hybrid_undercloud.yml ~/infrared/plugins/virsh/vars/topology/nodes/.
cp hybrid_controller.yml ~/infrared/plugins/virsh/vars/topology/nodes/.
cp 3_bridge_1_net.yml ~/infrared/plugins/virsh/vars/topology/network/.

Provision:

infrared virsh -v \
    --topology-nodes hybrid_undercloud:1,hybrid_controller:1 \
    -e override.controller.memory=28672 \
    -e override.undercloud.memory=28672 \
    -e override.controller.cpu=6 \
    -e override.undercloud.cpu=6 \
    --host-address 10.19.110.13 \
    --host-key ~/.ssh/id_rsa \
    --topology-network 3_bridges_1_net

    To clean (and only clean), just add "--cleanup yes"

Install Undercloud:

infrared tripleo-undercloud -v \
 --version=12 \
 --build=2017-11-03.4 \
 --images-task=rpm \
 --config-file ~/ir-osp12-dpdk-sriov/undercloud.conf

Introspect/Tag Overcloud:

ir tripleo-overcloud -vv --version 12 \
    --deployment-files  ~/ir-osp12-dpdk-sriov/templates \
    --overcloud-script ~/ir-osp12-dpdk-sriov/overcloud_deploy.sh \
     --build 2017-11-03.4 --introspect=yes --tagging=yes --deploy=no \
     -e provison_virsh_network_name=br-ctlplane --hybrid \
     ~/ir-osp12-dpdk-sriov/compute.json

CONTAINER STUFF BEFORE DEPLOY (perform as stack on undercloud):

openstack overcloud container image prepare   --namespace rhosp12   --tag 20171011.2 --prefix openstack --suffix docker   --pull-source docker-registry.engineering.redhat.com   --push-destination 192.0.2.1:8787   --images-file overcloud_containers.yaml
openstack overcloud container image upload --config-file overcloud_containers.yaml -v
openstack overcloud container image prepare   --namespace 192.0.2.1:8787/rhosp12   --tag 20171011.2   --prefix openstack   --suffix docker   --env-file ~/docker_registry.yaml
echo "  DockerInsecureRegistryAddress: 192.0.2.1:8787" >>   ~/docker_registry.yaml

Deploy Overcloud:

ir tripleo-overcloud -vv --version 12 \
     --deployment-files  ~/ir-osp12-dpdk-sriov/templates \
     --overcloud-script ~/ir-osp12-dpdk-sriov/overcloud_deploy.sh \
     --build 2017-11-03.4 --introspect=no --tagging=no --deploy=yes \
     -e provison_virsh_network_name=br-ctlplane --hybrid \
     ~/ir-osp12-dpdk-sriov/compute.json
